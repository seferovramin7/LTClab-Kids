<!DOCTYPE html>
<!--
EmailJS Setup Instructions:
1. Go to https://www.emailjs.com/
2. Create account and get your Public Key
3. Replace "YOUR_PUBLIC_KEY" in the JavaScript with your actual public key
4. Create two email templates:
   - template_user: For sending results to users
   - template_ltc: For sending results to LTC Lab
5. Template variables to use:
   - {{to_name}}, {{user_name}}, {{user_surname}}, {{user_email}}
   - {{result1_name}}, {{result2_name}}, {{result3_name}}
   - {{student_choices}}, {{parent_choices}}
   - {{timestamp}}
-->
<html lang="az">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LTC Lab - İnteraktiv Layihə Məsləhətçisi</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --ltc-primary: #C32360;
            --ltc-secondary: #1BACEE;
            --ltc-dark: #1a1a1a;
            --ltc-light-gray: #f8fafc;
            --ltc-medium-gray: #64748b;
            --ltc-border: #e2e8f0;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            min-height: 100vh;
        }
        
        .ltc-gradient {
            background: linear-gradient(135deg, var(--ltc-primary) 0%, var(--ltc-secondary) 100%);
        }
        
        .ltc-gradient-light {
            background: linear-gradient(135deg, rgba(195, 35, 96, 0.05) 0%, rgba(27, 172, 238, 0.05) 100%);
        }
        
        .screen {
            display: none;
        }
        
        .screen.active {
            display: block;
            animation: slideIn 0.6s cubic-bezier(0.16, 1, 0.3, 1);
        }
        
        .question-card {
            display: none;
        }
        
        .question-card.active {
            display: block;
            animation: fadeInUp 0.5s cubic-bezier(0.16, 1, 0.3, 1);
        }
        
        @keyframes slideIn {
            from { 
                opacity: 0; 
                transform: translateY(20px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }
        
        @keyframes fadeInUp {
            from { 
                opacity: 0; 
                transform: translateY(15px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }
        
        .option-btn {
            transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
            position: relative;
            overflow: hidden;
        }
        
        .option-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: left 0.5s;
        }
        
        .option-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            border-color: var(--ltc-primary);
        }
        
        .option-btn:hover::before {
            left: 100%;
        }
        
        .progress-bar {
            transition: width 0.6s cubic-bezier(0.16, 1, 0.3, 1);
            background: linear-gradient(90deg, var(--ltc-primary) 0%, var(--ltc-secondary) 100%);
        }
        
        .ltc-card {
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .ltc-btn-primary {
            background: linear-gradient(135deg, var(--ltc-primary) 0%, var(--ltc-secondary) 100%);
            transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
        }
        
        .ltc-btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(195, 35, 96, 0.3);
        }
        
        .logo-container {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 2rem;
        }
        
        .floating-shapes {
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
            z-index: -1;
        }
        
        .floating-shapes::before,
        .floating-shapes::after {
            content: '';
            position: absolute;
            border-radius: 50%;
            background: linear-gradient(135deg, rgba(195, 35, 96, 0.1) 0%, rgba(27, 172, 238, 0.1) 100%);
            animation: float 6s ease-in-out infinite;
        }
        
        .floating-shapes::before {
            width: 300px;
            height: 300px;
            top: -150px;
            right: -150px;
            animation-delay: -3s;
        }
        
        .floating-shapes::after {
            width: 200px;
            height: 200px;
            bottom: -100px;
            left: -100px;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(180deg); }
        }
    </style>
</head>
<body class="text-gray-800 min-h-screen flex items-center justify-center p-4 relative">
    <div class="floating-shapes"></div>
    
    <div id="app-container" class="w-full max-w-4xl mx-auto ltc-card rounded-3xl shadow-2xl overflow-hidden relative">
        <div id="app-content" class="p-8 md:p-12">

        <!-- User Info Screen -->
        <div id="user-info-screen" class="screen active">
            <div class="text-center mb-8">
                <div class="logo-container">
                    <svg width="120" height="44" viewBox="0 0 92 34" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M1.24199 27.0645V7.79481H6.4734V22.8492H14.2641V27.0645H1.24199ZM14.8738 12.01V7.79481H31.6218V12.01H25.8258V27.0645H20.6697V12.01H14.8738ZM51.9998 15.0209H46.6931C46.6555 14.5818 46.5551 14.1835 46.392 13.826C46.2352 13.4684 46.0157 13.1611 45.7334 12.9039C45.4574 12.6404 45.1218 12.4397 44.7266 12.3017C44.3315 12.1575 43.883 12.0853 43.3812 12.0853C42.503 12.0853 41.7597 12.2986 41.1512 12.7251C40.5491 13.1517 40.0911 13.7633 39.7775 14.5599C39.4702 15.3565 39.3165 16.3131 39.3165 17.4296C39.3165 18.6089 39.4733 19.5968 39.7869 20.3935C40.1068 21.1838 40.5679 21.7797 41.17 22.1812C41.7722 22.5764 42.4967 22.7739 43.3435 22.7739C43.8265 22.7739 44.2593 22.7144 44.642 22.5952C45.0246 22.4697 45.3571 22.291 45.6393 22.0589C45.9216 21.8268 46.1505 21.5476 46.3262 21.2215C46.5081 20.889 46.6304 20.5158 46.6931 20.1018L51.9998 20.1394C51.9371 20.9549 51.7081 21.786 51.313 22.6328C50.9178 23.4733 50.3564 24.2512 49.6287 24.9662C48.9074 25.6751 48.0135 26.2459 46.9472 26.6787C45.8808 27.1115 44.642 27.3279 43.2306 27.3279C41.4617 27.3279 39.8747 26.9484 38.4697 26.1894C37.0709 25.4304 35.9637 24.3139 35.1483 22.8398C34.3391 21.3657 33.9345 19.5623 33.9345 17.4296C33.9345 15.2844 34.3485 13.4778 35.1765 12.01C36.0045 10.536 37.121 9.42257 38.5261 8.66985C39.9312 7.91085 41.4994 7.53136 43.2306 7.53136C44.4475 7.53136 45.5672 7.69758 46.5896 8.03003C47.6121 8.36249 48.5091 8.84862 49.2806 9.48843C50.0521 10.122 50.6731 10.9029 51.1436 11.8313C51.614 12.7596 51.8994 13.8228 51.9998 15.0209Z" fill="#1a1a1a"/>
                        <rect x="58.9312" y="0.5" width="33.0688" height="33" rx="4" fill="url(#paint0_linear_207_1581)"/>
                        <path d="M66.8864 11.0844V23.1279H65.4985V11.0844H66.8864ZM72.0863 23.3396C71.5139 23.3396 70.9945 23.2318 70.528 23.0162C70.0614 22.7967 69.6909 22.4811 69.4165 22.0694C69.1421 21.6539 69.0049 21.152 69.0049 20.564C69.0049 20.0465 69.1068 19.627 69.3107 19.3055C69.5145 18.9801 69.787 18.7253 70.1281 18.541C70.4691 18.3568 70.8455 18.2196 71.2572 18.1294C71.6727 18.0353 72.0902 17.9608 72.5097 17.9059C73.0586 17.8354 73.5036 17.7824 73.8446 17.7472C74.1896 17.7079 74.4405 17.6433 74.5974 17.5531C74.7581 17.4629 74.8385 17.3061 74.8385 17.0826V17.0356C74.8385 16.4554 74.6797 16.0045 74.3621 15.6831C74.0485 15.3616 73.5722 15.2008 72.9331 15.2008C72.2706 15.2008 71.7511 15.3459 71.3748 15.636C70.9984 15.9261 70.7338 16.2358 70.5809 16.5651L69.2636 16.0947C69.4988 15.5458 69.8125 15.1185 70.2045 14.8127C70.6005 14.503 71.0317 14.2874 71.4983 14.1659C71.9687 14.0404 72.4313 13.9777 72.8861 13.9777C73.1762 13.9777 73.5094 14.013 73.8858 14.0835C74.2661 14.1502 74.6326 14.2893 74.9855 14.501C75.3422 14.7127 75.6382 15.0323 75.8734 15.4596C76.1087 15.8869 76.2263 16.4593 76.2263 17.1767V23.1279H74.8385V21.9048H74.7679C74.6738 22.1008 74.517 22.3105 74.2974 22.534C74.0779 22.7575 73.7858 22.9476 73.4212 23.1044C73.0566 23.2612 72.6117 23.3396 72.0863 23.3396ZM72.298 22.0929C72.8469 22.0929 73.3095 21.9851 73.6859 21.7695C74.0661 21.5539 74.3523 21.2755 74.5444 20.9345C74.7404 20.5934 74.8385 20.2347 74.8385 19.8583V18.5881C74.7797 18.6587 74.6503 18.7233 74.4503 18.7821C74.2543 18.837 74.0269 18.886 73.7682 18.9292C73.5134 18.9684 73.2644 19.0036 73.0213 19.035C72.7822 19.0625 72.5881 19.086 72.4392 19.1056C72.0785 19.1526 71.7413 19.2291 71.4277 19.3349C71.118 19.4369 70.8671 19.5917 70.675 19.7995C70.4868 20.0034 70.3927 20.2817 70.3927 20.6345C70.3927 21.1168 70.5711 21.4814 70.9278 21.7283C71.2885 21.9714 71.7452 22.0929 72.298 22.0929ZM78.9475 23.1279V11.0844H80.3354V15.5302H80.453C80.5549 15.3733 80.6961 15.1734 80.8764 14.9303C81.0607 14.6833 81.3233 14.4638 81.6644 14.2717C82.0094 14.0757 82.4759 13.9777 83.064 13.9777C83.8245 13.9777 84.4949 14.1678 85.0752 14.5481C85.6554 14.9284 86.1082 15.4674 86.4336 16.1653C86.759 16.8631 86.9217 17.6864 86.9217 18.6351C86.9217 19.5917 86.759 20.4209 86.4336 21.1226C86.1082 21.8205 85.6573 22.3615 85.081 22.7457C84.5047 23.126 83.8402 23.3161 83.0875 23.3161C82.5073 23.3161 82.0427 23.2201 81.6938 23.028C81.3449 22.8319 81.0763 22.6104 80.8882 22.3634C80.7 22.1125 80.5549 21.9048 80.453 21.7401H80.2883V23.1279H78.9475ZM80.3119 18.6116C80.3119 19.2938 80.4118 19.8955 80.6118 20.417C80.8117 20.9345 81.1038 21.3402 81.488 21.6342C81.8722 21.9244 82.3426 22.0694 82.8993 22.0694C83.4796 22.0694 83.9637 21.9165 84.3518 21.6107C84.7439 21.301 85.0379 20.8854 85.2339 20.364C85.4339 19.8387 85.5339 19.2546 85.5339 18.6116C85.5339 17.9765 85.4358 17.4041 85.2398 16.8945C85.0477 16.3809 84.7556 15.9751 84.3636 15.6772C83.9755 15.3753 83.4874 15.2244 82.8993 15.2244C82.3348 15.2244 81.8604 15.3675 81.4762 15.6537C81.092 15.9359 80.8019 16.3319 80.6059 16.8415C80.4099 17.3473 80.3119 17.9373 80.3119 18.6116Z" fill="white"/>
                        <defs>
                            <linearGradient id="paint0_linear_207_1581" x1="94.7557" y1="0.499998" x2="60.4095" y2="34.9729" gradientUnits="userSpaceOnUse">
                                <stop stop-color="#C32360"/>
                                <stop offset="1" stop-color="#1BACEE"/>
                            </linearGradient>
                        </defs>
                    </svg>
                </div>
                
                <h1 class="text-4xl md:text-5xl font-bold mb-4 bg-gradient-to-r from-pink-600 to-blue-500 bg-clip-text text-transparent">
                    LTC Kids
                </h1>
                <p class="text-lg text-gray-600 mb-8 max-w-2xl mx-auto leading-relaxed font-light">
                    Zəhmət olmasa əlaqə məlumatlarınızı daxil edin ki, nəticələri sizə göndərə bilək.
                </p>
            </div>
            
            <form id="user-info-form" class="max-w-md mx-auto space-y-6">
                <div>
                    <label for="user-name" class="block text-sm font-semibold text-gray-700 mb-2">Ad</label>
                    <input type="text" id="user-name" name="user-name" required 
                           class="w-full px-4 py-3 rounded-2xl border-2 border-gray-200 focus:border-pink-500 focus:outline-none transition-colors">
                </div>
                
                <div>
                    <label for="user-surname" class="block text-sm font-semibold text-gray-700 mb-2">Soyad</label>
                    <input type="text" id="user-surname" name="user-surname" required 
                           class="w-full px-4 py-3 rounded-2xl border-2 border-gray-200 focus:border-pink-500 focus:outline-none transition-colors">
                </div>
                
                <div>
                    <label for="user-email" class="block text-sm font-semibold text-gray-700 mb-2">Email</label>
                    <input type="email" id="user-email" name="user-email" required 
                           class="w-full px-4 py-3 rounded-2xl border-2 border-gray-200 focus:border-pink-500 focus:outline-none transition-colors">
                </div>
                
                <button type="submit" class="w-full ltc-btn-primary text-white font-semibold py-4 px-12 rounded-2xl text-lg shadow-xl">
                    Sorğuya Başla
                </button>
            </form>
        </div>

        <!-- Start Screen -->
        <div id="start-screen" class="screen text-center">
            <div class="logo-container">
                <svg width="120" height="44" viewBox="0 0 92 34" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M1.24199 27.0645V7.79481H6.4734V22.8492H14.2641V27.0645H1.24199ZM14.8738 12.01V7.79481H31.6218V12.01H25.8258V27.0645H20.6697V12.01H14.8738ZM51.9998 15.0209H46.6931C46.6555 14.5818 46.5551 14.1835 46.392 13.826C46.2352 13.4684 46.0157 13.1611 45.7334 12.9039C45.4574 12.6404 45.1218 12.4397 44.7266 12.3017C44.3315 12.1575 43.883 12.0853 43.3812 12.0853C42.503 12.0853 41.7597 12.2986 41.1512 12.7251C40.5491 13.1517 40.0911 13.7633 39.7775 14.5599C39.4702 15.3565 39.3165 16.3131 39.3165 17.4296C39.3165 18.6089 39.4733 19.5968 39.7869 20.3935C40.1068 21.1838 40.5679 21.7797 41.17 22.1812C41.7722 22.5764 42.4967 22.7739 43.3435 22.7739C43.8265 22.7739 44.2593 22.7144 44.642 22.5952C45.0246 22.4697 45.3571 22.291 45.6393 22.0589C45.9216 21.8268 46.1505 21.5476 46.3262 21.2215C46.5081 20.889 46.6304 20.5158 46.6931 20.1018L51.9998 20.1394C51.9371 20.9549 51.7081 21.786 51.313 22.6328C50.9178 23.4733 50.3564 24.2512 49.6287 24.9662C48.9074 25.6751 48.0135 26.2459 46.9472 26.6787C45.8808 27.1115 44.642 27.3279 43.2306 27.3279C41.4617 27.3279 39.8747 26.9484 38.4697 26.1894C37.0709 25.4304 35.9637 24.3139 35.1483 22.8398C34.3391 21.3657 33.9345 19.5623 33.9345 17.4296C33.9345 15.2844 34.3485 13.4778 35.1765 12.01C36.0045 10.536 37.121 9.42257 38.5261 8.66985C39.9312 7.91085 41.4994 7.53136 43.2306 7.53136C44.4475 7.53136 45.5672 7.69758 46.5896 8.03003C47.6121 8.36249 48.5091 8.84862 49.2806 9.48843C50.0521 10.122 50.6731 10.9029 51.1436 11.8313C51.614 12.7596 51.8994 13.8228 51.9998 15.0209Z" fill="#1a1a1a"/>
                    <rect x="58.9312" y="0.5" width="33.0688" height="33" rx="4" fill="url(#paint0_linear_207_1581)"/>
                    <path d="M66.8864 11.0844V23.1279H65.4985V11.0844H66.8864ZM72.0863 23.3396C71.5139 23.3396 70.9945 23.2318 70.528 23.0162C70.0614 22.7967 69.6909 22.4811 69.4165 22.0694C69.1421 21.6539 69.0049 21.152 69.0049 20.564C69.0049 20.0465 69.1068 19.627 69.3107 19.3055C69.5145 18.9801 69.787 18.7253 70.1281 18.541C70.4691 18.3568 70.8455 18.2196 71.2572 18.1294C71.6727 18.0353 72.0902 17.9608 72.5097 17.9059C73.0586 17.8354 73.5036 17.7824 73.8446 17.7472C74.1896 17.7079 74.4405 17.6433 74.5974 17.5531C74.7581 17.4629 74.8385 17.3061 74.8385 17.0826V17.0356C74.8385 16.4554 74.6797 16.0045 74.3621 15.6831C74.0485 15.3616 73.5722 15.2008 72.9331 15.2008C72.2706 15.2008 71.7511 15.3459 71.3748 15.636C70.9984 15.9261 70.7338 16.2358 70.5809 16.5651L69.2636 16.0947C69.4988 15.5458 69.8125 15.1185 70.2045 14.8127C70.6005 14.503 71.0317 14.2874 71.4983 14.1659C71.9687 14.0404 72.4313 13.9777 72.8861 13.9777C73.1762 13.9777 73.5094 14.013 73.8858 14.0835C74.2661 14.1502 74.6326 14.2893 74.9855 14.501C75.3422 14.7127 75.6382 15.0323 75.8734 15.4596C76.1087 15.8869 76.2263 16.4593 76.2263 17.1767V23.1279H74.8385V21.9048H74.7679C74.6738 22.1008 74.517 22.3105 74.2974 22.534C74.0779 22.7575 73.7858 22.9476 73.4212 23.1044C73.0566 23.2612 72.6117 23.3396 72.0863 23.3396ZM72.298 22.0929C72.8469 22.0929 73.3095 21.9851 73.6859 21.7695C74.0661 21.5539 74.3523 21.2755 74.5444 20.9345C74.7404 20.5934 74.8385 20.2347 74.8385 19.8583V18.5881C74.7797 18.6587 74.6503 18.7233 74.4503 18.7821C74.2543 18.837 74.0269 18.886 73.7682 18.9292C73.5134 18.9684 73.2644 19.0036 73.0213 19.035C72.7822 19.0625 72.5881 19.086 72.4392 19.1056C72.0785 19.1526 71.7413 19.2291 71.4277 19.3349C71.118 19.4369 70.8671 19.5917 70.675 19.7995C70.4868 20.0034 70.3927 20.2817 70.3927 20.6345C70.3927 21.1168 70.5711 21.4814 70.9278 21.7283C71.2885 21.9714 71.7452 22.0929 72.298 22.0929ZM78.9475 23.1279V11.0844H80.3354V15.5302H80.453C80.5549 15.3733 80.6961 15.1734 80.8764 14.9303C81.0607 14.6833 81.3233 14.4638 81.6644 14.2717C82.0094 14.0757 82.4759 13.9777 83.064 13.9777C83.8245 13.9777 84.4949 14.1678 85.0752 14.5481C85.6554 14.9284 86.1082 15.4674 86.4336 16.1653C86.759 16.8631 86.9217 17.6864 86.9217 18.6351C86.9217 19.5917 86.759 20.4209 86.4336 21.1226C86.1082 21.8205 85.6573 22.3615 85.081 22.7457C84.5047 23.126 83.8402 23.3161 83.0875 23.3161C82.5073 23.3161 82.0427 23.2201 81.6938 23.028C81.3449 22.8319 81.0763 22.6104 80.8882 22.3634C80.7 22.1125 80.5549 21.9048 80.453 21.7401H80.2883V23.1279H78.9475ZM80.3119 18.6116C80.3119 19.2938 80.4118 19.8955 80.6118 20.417C80.8117 20.9345 81.1038 21.3402 81.488 21.6342C81.8722 21.9244 82.3426 22.0694 82.8993 22.0694C83.4796 22.0694 83.9637 21.9165 84.3518 21.6107C84.7439 21.301 85.0379 20.8854 85.2339 20.364C85.4339 19.8387 85.5339 19.2546 85.5339 18.6116C85.5339 17.9765 85.4358 17.4041 85.2398 16.8945C85.0477 16.3809 84.7556 15.9751 84.3636 15.6772C83.9755 15.3753 83.4874 15.2244 82.8993 15.2244C82.3348 15.2244 81.8604 15.3675 81.4762 15.6537C81.092 15.9359 80.8019 16.3319 80.6059 16.8415C80.4099 17.3473 80.3119 17.9373 80.3119 18.6116Z" fill="white"/>
                    <defs>
                        <linearGradient id="paint0_linear_207_1581" x1="94.7557" y1="0.499998" x2="60.4095" y2="34.9729" gradientUnits="userSpaceOnUse">
                            <stop stop-color="#C32360"/>
                            <stop offset="1" stop-color="#1BACEE"/>
                        </linearGradient>
                    </defs>
                </svg>
            </div>
            
            <h1 class="text-4xl md:text-5xl font-bold mb-4 bg-gradient-to-r from-pink-600 to-blue-500 bg-clip-text text-transparent">
                LTC Kids
            </h1>
            <p class="text-lg text-gray-600 mb-10 max-w-2xl mx-auto leading-relaxed font-light">
                Bu interaktiv sorğu ilə sizin üçün ən uyğun Arduino və Süni İntellekt layihəsini birlikdə kəşf edək. Proses iki mərhələdən ibarət olacaq: əvvəlcə gənc ixtiraçı, sonra isə valideyn sualları cavablandıracaq.
            </p>
            <button id="start-btn" class="ltc-btn-primary text-white font-semibold py-4 px-12 rounded-2xl text-lg shadow-xl">
                Sorğuya Başla
            </button>
        </div>

        <!-- Questionnaire Screen -->
        <div id="questionnaire-screen" class="screen">
            <div id="quiz-header" class="mb-8 text-center">
                <h2 id="quiz-title" class="text-3xl font-bold text-gray-800 mb-2"></h2>
                <p id="quiz-subtitle" class="text-gray-600 font-light"></p>
            </div>
            <!-- Progress Bar -->
            <div class="w-full bg-gray-200 rounded-full h-2 mb-8 overflow-hidden">
                <div id="progress-bar" class="progress-bar h-2 rounded-full" style="width: 0%"></div>
            </div>
            <div id="question-container" class="min-h-[400px]">
                <!-- Questions will be injected here -->
            </div>
        </div>

        <!-- Results Screen -->
        <div id="results-screen" class="screen">
            <div class="text-center">
                <div class="mb-6">
                    <div class="w-16 h-16 ltc-gradient rounded-full flex items-center justify-center mx-auto mb-4">
                        <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                        </svg>
                    </div>
                    <h2 class="text-4xl font-bold text-gray-800 mb-3">Analiz Tamamlandı!</h2>
                    <p class="text-lg text-gray-600 mb-10 max-w-2xl mx-auto font-light">
                        Şagirdin maraqları və valideynin gözləntiləri nəzərə alınaraq, sizin üçün ən yüksək uyğunluq göstərən layihələr bunlardır:
                    </p>
                </div>
                <div id="results-container" class="space-y-6 text-left mb-10">
                    <!-- Results will be injected here -->
                </div>
                
                <!-- Email Status -->
                <div id="email-status" class="mb-6 p-4 rounded-2xl text-center" style="display: none;">
                    <div id="email-loading" class="flex items-center justify-center">
                        <svg class="animate-spin h-5 w-5 mr-3 text-blue-500" viewBox="0 0 24 24">
                            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" fill="none"></circle>
                            <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                        </svg>
                        <span>Nəticələr email olaraq göndərilir...</span>
                    </div>
                    <div id="email-success" class="text-green-600" style="display: none;">
                        ✅ Email uğurla göndərildi! Zəhmət olmasa email qutunuzu yoxlayın.
                    </div>
                    <div id="email-error" class="text-red-600" style="display: none;">
                        ❌ Email göndərilmədi. Zəhmət olmasa internet bağlantınızı yoxlayın.
                    </div>
                </div>
                
                <button id="restart-btn" class="bg-gray-400 hover:bg-gray-500 text-white font-semibold py-3 px-10 rounded-2xl text-lg transition-all duration-300">
                    Yenidən Başla
                </button>
            </div>
        </div>

    </div>
</div>

<script>
    // --- DATA ---
    const SCORE_PROFILES = {
        HOME_AUTO: { name: 'Gələcəyin Evi: Ağıllı Məkanlar', icon: '🏠' },
        FASHION_TECH: { name: 'Moda və Stil Texnologiyaları', icon: '👗' },
        ECOLOGY: { name: 'Yaşıl Texnologiyalar', icon: '🌿' },
        GAMES_ENTERTAINMENT: { name: 'Rəqəmsal Əyləncə və Oyunlar', icon: '🎮' },
        ROBOTICS: { name: 'Robotlar Dünyası', icon: '🤖' },
        URBAN_TECH: { name: 'Ağıllı Şəhər və Nəqliyyat', icon: '🏙️' },
        HEALTH_CARE: { name: 'Sağlam Həyat və Dəstək', icon: '❤️' },
        SECURITY_LOGIC: { name: 'Təhlükəsiz Həyat', icon: '🛡️' },
        ART_DESIGN: { name: 'Kreativ Dizayn və Rəqəmsal Sənət', icon: '🎨' },
        BUSINESS: { name: 'Gənc Sahibkar', icon: '📈' }
    };

    const studentQuestions = [
        { text: "Boş vaxtlarında aşağıdakılardan hansını etmək sənə daha çox zövq verir?", options: [
                { text: "LEGO və ya konstruktorla yeni qurğular yığmaq.", scores: { ROBOTICS: 2, HOME_AUTO: 1 } },
                { text: "Rəsm çəkmək, fərqli materiallardan nəsə düzəltmək, dizayn etmək.", scores: { ART_DESIGN: 2, FASHION_TECH: 1 } },
                { text: "Kompüterdə və ya telefonda oyunlar oynamaq.", scores: { GAMES_ENTERTAINMENT: 2 } },
                { text: "Heyvanlar, bitkilər haqqında sənədli filmlərə baxmaq, təbiətdə olmaq.", scores: { ECOLOGY: 2, HEALTH_CARE: 1 } }
            ]},
        { text: "Bir qutun var və onu heç kimin aça bilməməsini istəyirsən. Hansı müdafiə üsulunu seçərdin?", options: [
                { text: "Yalnız mənim barmaq izimlə və ya gizli kodla açılan kilid.", scores: { SECURITY_LOGIC: 2, ROBOTICS: 1 } },
                { text: "Qutuya yaxınlaşanda səs-küy salan bir siqnalizasiya.", scores: { HOME_AUTO: 1, SECURITY_LOGIC: 1 } },
                { text: "Qutunu çox yaxşı gizlədərdim, heç kimin ağlına gəlməyən bir yerdə.", scores: { GAMES_ENTERTAINMENT: 1 } },
                { text: "Qutunun üzərini elə bəzəyərdim ki, heç kim onun bir seyf olduğunu başa düşməzdi.", scores: { ART_DESIGN: 2 } }
            ]},
        { text: "Dərsdən sonra yorğun gəlmisən. Hansı texnoloji köməkçi sənin üçün ən faydalı olardı?", options: [
                { text: "Otağımın işığını və temperaturunu avtomatik ideal vəziyyətə gətirən bir sistem.", scores: { HOME_AUTO: 2, HEALTH_CARE: 1 } },
                { text: "Mənim üçün sağlam və dadlı yemək hazırlayan bir robot.", scores: { ROBOTICS: 2, HEALTH_CARE: 1 } },
                { text: "Əhvalımı yaxşılaşdıran musiqini avtomatik seçib çalan dinamiklər.", scores: { ART_DESIGN: 1, GAMES_ENTERTAINMENT: 1 } },
                { text: "Sabahkı dərslərim üçün çantamı özü yığan bir köməkçi.", scores: { BUSINESS: 1, ROBOTICS: 1 } }
            ]},
        { text: "Gələcəyin şəhərini necə təsəvvür edirsən?", options: [
                { text: "Hər yerdə robotların insanlara kömək etdiyi bir şəhər.", scores: { ROBOTICS: 2, URBAN_TECH: 1 } },
                { text: "Nəqliyyatın tam avtomatlaşdırıldığı, tıxacların olmadığı bir şəhər.", scores: { URBAN_TECH: 2, BUSINESS: 1 } },
                { text: "Binaların və parkların bol yaşıllıqla dolu olduğu, təmiz havalı bir şəhər.", scores: { ECOLOGY: 2, URBAN_TECH: 1 } },
                { text: "İnsanların geyimlərinin texnoloji olduğu, hər kəsin fərqli göründüyü bir şəhər.", scores: { FASHION_TECH: 2, ART_DESIGN: 1 } }
            ]},
        { text: "Əgər bir oyun yaratsaydın, o necə bir oyun olardı?", options: [
                { text: "Strateji və məntiq tələb edən, şəhər və ya qala qurma oyunu.", scores: { BUSINESS: 1, URBAN_TECH: 1, GAMES_ENTERTAINMENT: 1 } },
                { text: "Macəra dolu, gizli xəzinələr axtarılan bir kəşfiyyat oyunu.", scores: { GAMES_ENTERTAINMENT: 2 } },
                { text: "Öz geyimini və obrazını dizayn edə bildiyin bir yaradıcılıq oyunu.", scores: { FASHION_TECH: 2, ART_DESIGN: 1 } },
                { text: "Dostlarla yarışa biləcəyim sürət və reaksiya tələb edən bir oyun.", scores: { GAMES_ENTERTAINMENT: 2 } }
            ]},
        { text: "Bir əşyanı düzəldərkən sənin üçün ən vacib olan nədir?", options: [
                { text: "Onun mükəmməl və səhvsiz işləməsi.", scores: { ROBOTICS: 1, SECURITY_LOGIC: 1, ENGINEERING:1 } },
                { text: "Onun gözəl, fərqli və diqqətçəkən görünməsi.", scores: { ART_DESIGN: 2, FASHION_TECH: 1 } },
                { text: "Onun kiminsə işinə yaraması, həyatını asanlaşdırması.", scores: { HEALTH_CARE: 2, ECOLOGY: 1 } },
                { text: "Prosesin özü, yeni bir şey kəşf etmək və öyrənmək.", scores: { GAMES_ENTERTAINMENT: 1 } }
            ]},
        { text: "Hansı fikir səni daha çox həyəcanlandırır?", options: [
                { text: "Yıxılan insanlara kömək edən bir tibbi robot.", scores: { ROBOTICS: 1, HEALTH_CARE: 2 } },
                { text: "Çirklənmiş suyu təmizləyən bir filtr sistemi.", scores: { ECOLOGY: 2 } },
                { text: "Sürücüsüz hərəkət edən bir velosiped.", scores: { URBAN_TECH: 2, ROBOTICS: 1 } },
                { text: "Mağazadakı bütün prosesləri idarə edən bir ağıllı sistem.", scores: { BUSINESS: 2, HOME_AUTO: 1 } }
            ]},
        { text: "Bir rəsm çəksəydin, bu nə olardı?", options: [
                { text: "Mürəkkəb bir mexanizmin və ya binanın detallı təsviri.", scores: { ROBOTICS: 1, URBAN_TECH: 1 } },
                { text: "Rəngarəng və abstrakt bir kompozisiya.", scores: { ART_DESIGN: 2 } },
                { text: "Gələcəkdən gəlmiş bir moda dizaynı.", scores: { FASHION_TECH: 2 } },
                { text: "Sakit bir təbiət mənzərəsi.", scores: { ECOLOGY: 2 } }
            ]},
        { text: "Bir problemi həll etmək üçün hansı yolu seçərsən?", options: [
                { text: "Əvvəlcə problemi hissələrə bölüb, hər birini ayrı-ayrılıqda həll edərəm.", scores: { SECURITY_LOGIC: 1, BUSINESS: 1 } },
                { text: "Problemin həllinin başqalarına necə təsir edəcəyini düşünərəm.", scores: { HEALTH_CARE: 1, ECOLOGY: 1 } },
                { text: "Ən ağlasığmaz və kreativ həll yolunu axtararam.", scores: { ART_DESIGN: 1, GAMES_ENTERTAINMENT: 1 } },
                { text: "Bu problemi həll etmək üçün hansı alətlər və ya qurğular lazım olduğunu araşdıraram.", scores: { ROBOTICS: 2 } }
            ]},
        { text: "Dostun üçün bir hədiyyə düzəltməlisən. Nə düzəldərdin?", options: [
                { text: "Onun sevdiyi oyunun personajının hərəkət edən fiqurunu.", scores: { ROBOTICS: 1, GAMES_ENTERTAINMENT: 2 } },
                { text: "Onun adının baş hərfləri ilə işıqlanan bir stolüstü lampa.", scores: { ART_DESIGN: 1, HOME_AUTO: 1 } },
                { text: "Duruşunu düz saxlamağa kömək edən bir ağıllı yastıqça.", scores: { HEALTH_CARE: 2 } },
                { text: "Üzərində ikinizin şəkli olan və musiqi çalan bir qutu.", scores: { ART_DESIGN: 2 } }
            ]}
    ];

    const parentQuestions = [
        { text: "Övladınızın asudə vaxtında ən çox nəyə diqqət yetirdiyini müşahidə edirsiniz?", options: [
                { text: "Bir şeylərin necə işlədiyini anlamağa, söküb-yığmağa.", scores: { ROBOTICS: 1, SECURITY_LOGIC: 1 } },
                { text: "Vizual yaradıcılığa, rəsmə, dizayna.", scores: { ART_DESIGN: 1, FASHION_TECH: 1 } },
                { text: "Qaydalara əsaslanan oyunlara, strategiya qurmağa.", scores: { GAMES_ENTERTAINMENT: 1, BUSINESS: 1 } },
                { text: "Canlılara qarşı həssaslığa, təbiətə və ya sosial məsələlərə.", scores: { ECOLOGY: 1, HEALTH_CARE: 1 } }
            ]},
        { text: "Bu kursun övladınıza hansı əsas bacarığı qazandırmasını hədəfləyirsiniz?", options: [
                { text: "Məntiqi və alqoritmik düşüncəni, gələcək mühəndislik biliklərinin təməlini.", scores: { ROBOTICS: 1, SECURITY_LOGIC: 1, URBAN_TECH: 1 } },
                { text: "Yaradıcılığını və təxəyyülünü istifadə edərək özünü ifadə etməsini.", scores: { ART_DESIGN: 1, FASHION_TECH: 1, GAMES_ENTERTAINMENT: 1 } },
                { text: "Real həyat problemlərinə texnoloji həllər tapmağı öyrənməsini.", scores: { ECOLOGY: 1, HEALTH_CARE: 1, BUSINESS: 1 } },
                { text: "Səbrlə bir layihə üzərində işləyib sona çatdırmaq vərdişini.", scores: { } }
            ]},
        { text: "Övladınız bir tapşırıqla qarşılaşanda hansı davranış daha xarakterikdir?", options: [
                { text: "Səhvlərdən qorxmur, cəsarətlə fərqli yolları sınayır.", scores: { GAMES_ENTERTAINMENT: 1, ART_DESIGN: 1 } },
                { text: "Çox sual verir, hər detalı aydınlaşdırmadan işə başlamır.", scores: { SECURITY_LOGIC: 1 } },
                { text: "Komanda ilə işləməyə, başqalarının fikrini almağa daha çox meyillidir.", scores: { BUSINESS: 1 } },
                { text: "Tək başına, səssizcə işləməyi üstün tutur.", scores: { ROBOTICS: 1 } }
            ]},
        { text: "Sizcə, övladınız üçün hansı tip layihə daha motivasiyaedici olar?", options: [
                { text: "Gündəlik həyatda istifadə edə biləcəyi praktiki bir cihaz.", scores: { HOME_AUTO: 1, HEALTH_CARE: 1 } },
                { text: "Gözəl və estetik görünüşü olan, bəzək və ya sənət əsəri.", scores: { ART_DESIGN: 1, FASHION_TECH: 1 } },
                { text: "Qaydaları olan, yarış elementi daşıyan bir oyun və ya robot.", scores: { GAMES_ENTERTAINMENT: 1, ROBOTICS: 1 } },
                { text: "Cəmiyyətə və ya təbiətə faydalı olan bir layihə.", scores: { ECOLOGY: 1, URBAN_TECH: 1 } }
            ]},
        { text: "Övladınızın gələcək karyerasını hansı sahəyə daha yaxın görürsünüz?", options: [
                { text: "Mühəndislik, İT, texniki sahələr.", scores: { ROBOTICS: 1, SECURITY_LOGIC: 1, URBAN_TECH: 1, BUSINESS: 1 } },
                { text: "Dizayn, incəsənət, moda, media.", scores: { ART_DESIGN: 1, FASHION_TECH: 1, GAMES_ENTERTAINMENT: 1 } },
                { text: "Tibb, psixologiya, ekologiya, sosial iş.", scores: { HEALTH_CARE: 1, ECOLOGY: 1 } },
                { text: "Hələ ki, müəyyən etmək çətindir, fərqli sahələri yoxlamasını istərdim.", scores: { } }
            ]},
        { text: "Övladınızın hansı qabiliyyətinin daha güclü olduğunu düşünürsünüz?", options: [
                { text: "Problem həll etmə və analitik düşüncə.", scores: { ROBOTICS: 1, SECURITY_LOGIC: 1 } },
                { text: "Vizual təxəyyül və estetik hissiyyat.", scores: { ART_DESIGN: 1, FASHION_TECH: 1 } },
                { text: "Empatiya və başqalarını anlamaq.", scores: { HEALTH_CARE: 1, ECOLOGY: 1 } },
                { text: "Sistemli düşünmə və planlaşdırma.", scores: { BUSINESS: 1, URBAN_TECH: 1 } }
            ]},
        { text: "Kursun sonunda əsas gözləntiniz nədir?", options: [
                { text: "Özünə inamının artması və yeni bir hobbiyə yiyələnməsi.", scores: { } },
                { text: "Konkret texniki bacarıqlar qazanması.", scores: { ROBOTICS: 1, SECURITY_LOGIC: 1 } },
                { text: "Yaradıcılığını ortaya çıxarması.", scores: { ART_DESIGN: 1, FASHION_TECH: 1 } },
                { text: "Gələcək peşə seçiminə kömək etməsi.", scores: { BUSINESS: 1, URBAN_TECH: 1 } }
            ]},
        { text: "Övladınız adətən hansı tip filmlərə və ya kitablara maraq göstərir?", options: [
                { text: "Fantastika, robotlar və gələcək texnologiyaları haqqında.", scores: { ROBOTICS: 1, URBAN_TECH: 1 } },
                { text: "Macəra və kəşfiyyat.", scores: { GAMES_ENTERTAINMENT: 1, ECOLOGY: 1 } },
                { text: "Detektiv və tapmacalarla dolu olanlar.", scores: { SECURITY_LOGIC: 1 } },
                { text: "Dizayn, moda və ya incəsənət haqqında.", scores: { ART_DESIGN: 1, FASHION_TECH: 1 } }
            ]},
        { text: "Övladınızın bir şeyə marağını nə daha uzun müddət saxlayır?", options: [
                { text: "Rəqabət və qalib gəlmək imkanı.", scores: { GAMES_ENTERTAINMENT: 1 } },
                { text: "Daim yeni bir şey kəşf etmək və təkmilləşdirmək.", scores: { ROBOTICS: 1, BUSINESS: 1 } },
                { text: "Yaratdığı şeyin başqaları tərəfindən bəyənilməsi.", scores: { ART_DESIGN: 1, FASHION_TECH: 1 } },
                { text: "Yaratdığı şeyin faydalı və köməkçi olması.", scores: { HEALTH_CARE: 1, ECOLOGY: 1 } }
            ]},
        { text: "Hansı ifadə övladınızı daha yaxşı təsvir edir?", options: [
                { text: "Praktikdir, nəzəriyyədən çox real nəticələrə önəm verir.", scores: { HOME_AUTO: 1, BUSINESS: 1 } },
                { text: "Xəyalpərəstdir, ideyaları və təxəyyülü güclüdür.", scores: { ART_DESIGN: 1, FASHION_TECH: 1, GAMES_ENTERTAINMENT: 1 } },
                { text: "Ədalətlidir, qaydalara və struktura hörmət edir.", scores: { SECURITY_LOGIC: 1 } },
                { text: "Qayğıkeşdir, ətrafındakıların hisslərinə qarşı həssasdır.", scores: { HEALTH_CARE: 1, ECOLOGY: 1 } }
            ]}
    ];

    const allProjects = {
        HOME_AUTO: [ { name: "Öyrənən İşıqlandırma", id: "1.1" }, { name: "Fərdi Oyanış Sistemi", id: "1.2" }, { name: "Ağıllı Bitki Güldanı", id: "1.3" }, { name: "Səsli İdarəetmə Mərkəzi", id: "1.4" }, { name: "Giriş-Çıxış Qeydiyyatçısı", id: "1.5" }, { name: "İqlimə Nəzarət Qurğusu", id: "1.6" }, { name: "Avtomatik Pəncərə Sistemi", id: "1.7" }, { name: "Gigiyenik Zibil Qutusu", id: "1.8" }, { name: "Ev Heyvanı üçün Virtual Sərhəd", id: "1.9" }, { name: "Mətbəx Təhlükəsizliyi", id: "1.10" } ],
        FASHION_TECH: [ { name: "Rəngə Uyğunlaşan Aksesuar", id: "2.1" }, { name: "İşıqlı Addımlar", id: "2.2" }, { name: "İnteraktiv T-shirt", id: "2.3" }, { name: "Musiqi Ritmi ilə Parıldayan Geyim", id: "2.4" }, { name: "Duruş Korrektoru Çanta", id: "2.5" }, { name: "“Əhval-Ruhiyyə” Bilərziyi", id: "2.6" }, { name: "Rəqəmsal Yelpik", id: "2.7" }, { name: "Avtomatik Çanta İşığı", id: "2.8" }, { name: "Temperatur Həssaslı Şərf", id: "2.9" }, { name: "Toxunuşla Dəyişən Naxış", id: "2.10" } ],
        ECOLOGY: [ { name: "Avtonom İstixana", id: "3.1" }, { name: "Hava Keyfiyyəti Monitorinq Stansiyası", id: "3.2" }, { name: "Tullantıların Avtomatik Təsnifatçısı", id: "3.3" }, { name: "Ornitoloji Müşahidəçi", id: "3.4" }, { name: "Heliostat: Günəş İzləyici Panel", id: "3.5" }, { name: "“Ağıllı” Kompost Sistemi", id: "3.6" }, { name: "Meşə Yanğını Erkən Xəbərdarlıq Sistemi", id: "3.7" }, { name: "Su Sızıntısı Detektoru", id: "3.8" }, { name: "Api-Monitor: Arı Pətəyinə Nəzarət", id: "3.9" }, { name: "Torpaq Sürüşməsi Xəbərdarlığı", id: "3.10" } ],
        GAMES_ENTERTAINMENT: [ { name: "Adaptiv Reaksiya Oyunu", id: "4.1" }, { name: "Jestlərlə İdarəetmə Konsolu", id: "4.2" }, { name: "Elektron Labirint", id: "4.3" }, { name: "“Simon” Yaddaş Platforması", id: "4.4" }, { name: "Rəqs Pedi", id: "4.5" }, { name: "Lazer Atıcılıq Poliqonu", id: "4.6" }, { name: "İnteraktiv Hekayə", id: "4.7" }, { name: "Stolüstü Oyun Köməkçisi (Dungeon Master)", id: "4.8" }, { name: "Texnoloji Xəzinə Axtarışı", id: "4.9" }, { name: "İnteraktiv Musiqi Qurğusu", id: "4.10" } ],
        ROBOTICS: [ { name: "Xətt İzləyən Robot", id: "5.1" }, { name: "Maneədən Yayınan Robot", id: "5.2" }, { name: "Sensorlu Robot Əl", id: "5.3" }, { name: "Sumo Robotu", id: "5.4" }, { name: "Avtonom Anbar Köməkçisi", id: "5.5" }, { name: "Qrafik Plotter", id: "5.6" }, { name: "Təmizlikçi Robot Prototipi", id: "5.7" }, { name: "Özünü Balanslayan Robot", id: "5.8" }, { name: "Obyekt Tanıyan Kəşfiyyatçı", id: "5.9" }, { name: "Sürü Robotları (Swarm Robotics)", id: "5.10" } ],
        URBAN_TECH: [ { name: "Adaptiv Svetofor Sistemi", id: "6.1" }, { name: "Ağıllı Parkinq Sistemi", id: "6.2" }, { name: "Avtomatlaşdırılmış Dəmiryol Keçidi", id: "6.3" }, { name: "Piyada Təhlükəsizliyi Platforması", id: "6.4" }, { name: "Ağıllı Küçə İşıqlandırması", id: "6.5" }, { name: "Sürətə Nəzarət Məntəqəsi", id: "6.6" }, { name: "İnteraktiv Avtobus Dayanacağı", id: "6.7" }, { name: "Velosiped üçün Təhlükəsizlik Sistemi", id: "6.8" }, { name: "Yol Səthinə Nəzarət", id: "6.9" }, { name: "Optimal Zibil Daşıma Marşrutu", id: "6.10" } ],
        HEALTH_CARE: [ { name: "Duruş Korrektoru", id: "7.1" }, { name: "Hidratasiya Nəzarətçisi", id: "7.2" }, { name: "Stress İdarəetmə Cihazı", id: "7.3" }, { name: "Fizioterapiya Köməkçisi", id: "7.4" }, { name: "Dərman Qəbulu Xatırladıcısı", id: "7.5" }, { name: "Yuxu Keyfiyyəti Analizatoru", id: "7.6" }, { name: "Gigiyena Nəzarətçisi", id: "7.7" }, { name: "Meditasiya Bələdçisi", id: "7.8" }, { name: "UV İndeksi Monitoru", id: "7.9" }, { name: "Ağıllı Əsa", id: "7.10" } ],
        SECURITY_LOGIC: [ { name: "Şifrəli Seyf", id: "8.1" }, { name: "Lazer Perimetr Mühafizəsi", id: "8.2" }, { name: "Biometrik Kilid", id: "8.3" }, { name: "Pəncərə və Qapı Mühafizə Sistemi", id: "8.4" }, { name: "Akustik Mühafizəçi", id: "8.5" }, { name: "Seysmik Siqnal Sistemi", id: "8.6" }, { name: "Yanğın Söndürmə Simulyatoru", id: "8.7" }, { name: "Hərəkət İzləyən Kamera Platforması", id: "8.8" }, { name: "Şübhəli Obyekt Detektoru", id: "8.9" }, { name: "Kriptoqrafik Mesajlaşma", id: "8.10" } ],
        ART_DESIGN: [ { name: "İnteraktiv İşıq İnstalyasiyası", id: "9.1" }, { name: "Musiqili Fəvvarə", id: "9.2" }, { name: "Avtomatlaşdırılmış Kölgə Teatrı", id: "9.3" }, { name: "Kinetik Heykəl", id: "9.4" }, { name: "“Pixel Art” Paneli", id: "9.5" }, { name: "Rəng Təsnifatçısı Qurğusu", id: "9.6" }, { name: "Səs Mənzərəsi Generatoru", id: "9.7" }, { name: "Rəng Örnekleyici Əlcək", id: "9.8" }, { name: "Avtomatik Xəttat", id: "9.9" }, { name: "Holoqrafik Proyeksiya", id: "9.10" } ],
        BUSINESS: [ { name: "Müştəri Axını Analizatoru", id: "10.1" }, { name: "“Ağıllı” Rəf Sistemi", id: "10.2" }, { name: "Müştəri Rəyi Terminalı", id: "10.3" }, { name: "İnteraktiv Vitrin", id: "10.4" }, { name: "Avtomatlaşdırılmış Satış Aparatı", id: "10.5" }, { name: "Növbə İdarəetmə Sistemi", id: "10.6" }, { name: "Dinamik Reklam Paneli", id: "10.7" }, { name: "Məhsul Tövsiyə Sistemi", id: "10.8" }, { name: "Anbar İqliminə Nəzarət", id: "10.9" }, { name: "Enerji Effektivliyi Sistemi", id: "10.10" } ]
    };

    // --- APP LOGIC ---
    let state = {
        currentStage: 'start', // 'student', 'parent', 'results'
        currentQuestionIndex: 0,
        scores: {},
        userInfo: {
            name: '',
            surname: '',
            email: ''
        },
        userChoices: {
            student: [],
            parent: []
        }
    };

    const screens = {
        userInfo: document.getElementById('user-info-screen'),
        start: document.getElementById('start-screen'),
        questionnaire: document.getElementById('questionnaire-screen'),
        results: document.getElementById('results-screen')
    };
    const userInfoForm = document.getElementById('user-info-form');
    const startBtn = document.getElementById('start-btn');
    const questionContainer = document.getElementById('question-container');
    const progressBar = document.getElementById('progress-bar');
    const resultsContainer = document.getElementById('results-container');
    const restartBtn = document.getElementById('restart-btn');
    const quizTitle = document.getElementById('quiz-title');
    const quizSubtitle = document.getElementById('quiz-subtitle');

    function initializeScores() {
        Object.keys(SCORE_PROFILES).forEach(key => {
            state.scores[key] = { student: 0, parent: 0, total: 0 };
        });
    }

    // Initialize EmailJS
    emailjs.init("Q63vsFmDk83Y0Q5bi"); // You'll need to replace this with your actual public key

    function showScreen(screenName) {
        Object.values(screens).forEach(s => s.classList.remove('active'));
        screens[screenName].classList.add('active');
    }

    function handleUserInfoSubmit(event) {
        event.preventDefault();
        
        // Get user information
        state.userInfo.name = document.getElementById('user-name').value;
        state.userInfo.surname = document.getElementById('user-surname').value;
        state.userInfo.email = document.getElementById('user-email').value;
        
        // Show start screen
        showScreen('start');
    }

    function startQuiz() {
        state.currentStage = 'student';
        state.currentQuestionIndex = 0;
        initializeScores();
        updateQuizUI();
        showScreen('questionnaire');
    }

    function updateQuizUI() {
        const isStudent = state.currentStage === 'student';
        const questions = isStudent ? studentQuestions : parentQuestions;

        quizTitle.textContent = isStudent ? "Gənc İxtiraçının Növbəsi" : "Valideynin Növbəsi";
        quizSubtitle.textContent = isStudent ? "Bu sualları övladınızın cavablandırması daha dəqiq nəticə verər." : "Bu suallar sizin gözləntilərinizi anlamaq üçündür.";

        const progress = (state.currentQuestionIndex / questions.length) * 100;
        progressBar.style.width = `${progress}%`;

        showQuestion();
    }

    function showQuestion() {
        const isStudent = state.currentStage === 'student';
        const questions = isStudent ? studentQuestions : parentQuestions;
        const question = questions[state.currentQuestionIndex];

        if (!question) {
            if(isStudent) {
                state.currentStage = 'parent';
                state.currentQuestionIndex = 0;
                updateQuizUI();
            } else {
                calculateAndShowResults();
            }
            return;
        }

        let optionsHtml = question.options.map((option) => `
                <button class="option-btn w-full text-left bg-white p-6 my-3 rounded-2xl border-2 border-gray-200 shadow-sm hover:shadow-md" data-scores='${JSON.stringify(option.scores)}'>
                    <span class="font-medium text-gray-800">${option.text}</span>
                </button>
            `).join('');

        questionContainer.innerHTML = `
                <div class="question-card active">
                    <div class="ltc-gradient-light p-6 rounded-2xl mb-8">
                        <h3 class="text-2xl md:text-3xl font-semibold text-gray-800 leading-relaxed">
                            <span class="inline-block w-8 h-8 ltc-gradient rounded-full text-white text-sm font-bold flex items-center justify-center mr-3">${state.currentQuestionIndex + 1}</span>
                            ${question.text}
                        </h3>
                    </div>
                    <div class="options-container space-y-3">${optionsHtml}</div>
                </div>
            `;

        document.querySelectorAll('.option-btn').forEach(button => {
            button.addEventListener('click', handleAnswer);
        });
    }

    function handleAnswer(event) {
        const scoresData = JSON.parse(event.currentTarget.dataset.scores);
        const scoreType = state.currentStage; // 'student' or 'parent'
        const selectedText = event.currentTarget.textContent.trim();

        // Track user choice
        const isStudent = state.currentStage === 'student';
        const questions = isStudent ? studentQuestions : parentQuestions;
        const currentQuestion = questions[state.currentQuestionIndex];
        
        state.userChoices[scoreType].push({
            questionIndex: state.currentQuestionIndex + 1,
            question: currentQuestion.text,
            answer: selectedText
        });

        Object.keys(scoresData).forEach(key => {
            if(state.scores[key]){
                state.scores[key][scoreType] += scoresData[key];
            }
        });

        state.currentQuestionIndex++;
        updateQuizUI();
    }

    function calculateAndShowResults() {
        // Calculate final scores with weights
        Object.keys(state.scores).forEach(key => {
            const studentScore = state.scores[key].student * 0.7; // 70% weight for student
            const parentScore = state.scores[key].parent * 0.3; // 30% weight for parent
            state.scores[key].total = studentScore + parentScore;
        });

        const sortedScores = Object.entries(state.scores)
            .map(([key, value]) => ({ key, ...value }))
            .sort((a, b) => b.total - a.total);

        const top3Profiles = sortedScores.slice(0, 3);

        resultsContainer.innerHTML = ''; // Clear previous results
        top3Profiles.forEach((profile, index) => {
            const profileInfo = SCORE_PROFILES[profile.key];
            const projectsForProfile = allProjects[profile.key];

            // Get 3 random projects from the category
            const randomProjects = [...projectsForProfile].sort(() => 0.5 - Math.random()).slice(0, 3);

            const projectLinksHtml = randomProjects.map(p =>
                `<li class="flex items-center py-2">
                    <div class="w-2 h-2 bg-gradient-to-r from-pink-500 to-blue-500 rounded-full mr-3"></div>
                    <span class="font-semibold text-gray-800">${p.name}</span>
                </li>`
            ).join('');

            resultsContainer.innerHTML += `
                    <div class="ltc-gradient-light p-8 rounded-3xl border border-gray-100 mb-6 shadow-lg hover:shadow-xl transition-all duration-300">
                        <div class="flex items-center mb-6">
                            <div class="w-16 h-16 bg-white rounded-2xl flex items-center justify-center mr-6 shadow-md">
                                <span class="text-3xl">${profileInfo.icon}</span>
                            </div>
                            <div>
                                <h3 class="font-bold text-2xl text-gray-800 mb-1">${profileInfo.name}</h3>
                                <div class="flex items-center">
                                    <div class="w-2 h-2 ltc-gradient rounded-full mr-2"></div>
                                    <p class="text-gray-600 font-medium">Yüksək Uyğunluq</p>
                                </div>
                            </div>
                        </div>
                        <div class="bg-white bg-opacity-60 p-6 rounded-2xl">
                            <p class="font-semibold text-gray-700 mb-4 flex items-center">
                                <svg class="w-5 h-5 mr-2 text-gray-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path>
                                </svg>
                                Tövsiyə olunan layihələr:
                            </p>
                            <ul class="list-none space-y-3">
                            ${projectLinksHtml}
                        </ul>
                        </div>
                    </div>
                `;
        });

        showScreen('results');
        
        // Send email with results
        sendResultsEmail(top3Profiles);
    }

    function sendResultsEmail(results) {
        // Show loading
        const emailStatus = document.getElementById('email-status');
        const emailLoading = document.getElementById('email-loading');
        const emailSuccess = document.getElementById('email-success');
        const emailError = document.getElementById('email-error');
        
        emailStatus.style.display = 'block';
        emailLoading.style.display = 'flex';
        emailSuccess.style.display = 'none';
        emailError.style.display = 'none';

        // Prepare email data
        const emailData = {
            to_email: state.userInfo.email,
            to_name: `${state.userInfo.name} ${state.userInfo.surname}`,
            user_name: state.userInfo.name,
            user_surname: state.userInfo.surname,
            user_email: state.userInfo.email,
            
            // Results
            result1_name: results[0] ? SCORE_PROFILES[results[0].key].name : 'N/A',
            result1_icon: results[0] ? SCORE_PROFILES[results[0].key].icon : '',
            result2_name: results[1] ? SCORE_PROFILES[results[1].key].name : 'N/A',
            result2_icon: results[1] ? SCORE_PROFILES[results[1].key].icon : '',
            result3_name: results[2] ? SCORE_PROFILES[results[2].key].name : 'N/A',
            result3_icon: results[2] ? SCORE_PROFILES[results[2].key].icon : '',
            
            // All user choices formatted
            student_choices: formatChoicesForEmail(state.userChoices.student, 'Şagird'),
            parent_choices: formatChoicesForEmail(state.userChoices.parent, 'Valideyn'),
            
            timestamp: new Date().toLocaleString('az-AZ')
        };

        let emailsSent = 0;
        let emailsToSend = 2;
        let hasError = false;

        function checkComplete() {
            emailsSent++;
            if (emailsSent >= emailsToSend) {
                emailLoading.style.display = 'none';
                if (hasError) {
                    emailError.style.display = 'block';
                } else {
                    emailSuccess.style.display = 'block';
                }
            }
        }

        // Send to user
        emailjs.send('service_qycyzbh', 'template_user', emailData)
            .then(function(response) {
                console.log('Email sent to user successfully!', response.status, response.text);
                checkComplete();
            }, function(error) {
                console.log('Failed to send email to user...', error);
                hasError = true;
                checkComplete();
            });

        // Send to LTC Lab
        const ltcEmailData = {
            ...emailData,
            to_email: 'gel@ltclab.edu.az',
            to_name: 'LTC Lab Team'
        };

        emailjs.send('service_qycyzbh', 'template_ltc', ltcEmailData)
            .then(function(response) {
                console.log('Email sent to LTC Lab successfully!', response.status, response.text);
                checkComplete();
            }, function(error) {
                console.log('Failed to send email to LTC Lab...', error);
                hasError = true;
                checkComplete();
            });
    }

    function formatChoicesForEmail(choices, type) {
        let formatted = `${type} Cavabları:\n\n`;
        choices.forEach(choice => {
            formatted += `${choice.questionIndex}. ${choice.question}\n`;
            formatted += `Cavab: ${choice.answer}\n\n`;
        });
        return formatted;
    }

    function restartQuiz() {
        // Reset state
        state.currentStage = 'start';
        state.currentQuestionIndex = 0;
        state.scores = {};
        state.userInfo = { name: '', surname: '', email: '' };
        state.userChoices = { student: [], parent: [] };
        
        // Clear form
        document.getElementById('user-info-form').reset();
        
        // Show user info screen
        showScreen('userInfo');
    }

    // Event listeners
    userInfoForm.addEventListener('submit', handleUserInfoSubmit);
    startBtn.addEventListener('click', startQuiz);
    restartBtn.addEventListener('click', restartQuiz);

</script>
</body>
</html>